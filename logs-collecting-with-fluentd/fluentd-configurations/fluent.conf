<source>
  @type tail
  path /fluentd/log/files/app.log
  pos_file /fluentd/pos/app.log.pos
  tag app.errors-log
  read_from_head true
  <parse>
    @type json
  </parse>
</source>

<filter app.errors-log>
  @type grep
  <regexp>
    key level
    pattern ^ERROR$
  </regexp>
</filter>

<match app.errors-log>
  @type file
  path /output/errors
  <format>
    @type json
  </format>
</match>
